# 🧾 מערכת חילוץ טקסטים מקבצי PDF סרוקים

פרויקט זה נועד לחלץ טקסטים מתוך קבצי PDF — גם מטקסטים רגילים וגם מקבצים סרוקים באמצעות OCR (זיהוי תווים אופטי).  
המערכת מזהה האם הקובץ הוא טקסטואלי או סרוק, מחלצת את הטקסט, ומסווגת את הדוח לסוג **A** או **B**.

---

## ⚙️ התקנה והפעלה

### דרישות מוקדמות
- Python 3.11 ומעלה  
- Git  
- ספריית **Poppler** (להמרת PDF לתמונות)  
- ספריית **Tesseract OCR** (לקריאת טקסט מתמונות)

---

### 📦 התקנת סביבת העבודה

1. צרו סביבה וירטואלית:
   ```bash
   python -m venv venv
   venv\Scripts\activate


התקיני את הספריות הדרושות:

pip install pdfplumber pdf2image pytesseract pillow pandas opencv-python-headless reportlab


ודאו ש־Tesseract מותקן במחשב:

הנתיב צריך להיות (ברירת מחדל):

C:\Program Files\Tesseract-OCR\tesseract.exe


ודאי ש־Poppler מותקן (למשל):

C:\poppler\poppler-25.07.0\Library\bin

🚀 הפעלה

להרצת הקוד הראשי:

python src/extract.py


המערכת תבצע:

1.בדיקה אם הקובץ סרוק או טקסטואלי

2.חילוץ טקסט מתאים (OCR אם צריך)

3.סיווג סוג הדוח (A / B / Unknown)

4.תיקון שדות לוגיים (כניסה/יציאה, עמודת 100%)

5.יצירת קובץ PDF חדש עם גרסה מתוקנת

🧠 לוגיקת הסיווג

| סוג הדוח    | מאפיינים עיקריים                                    | תיאור                   |
| ----------- | --------------------------------------------------- | ----------------------- |
| **A**       | מכיל מילים כמו "חברה", "בע"מ", "Company"            | דוחות ארגוניים של חברות |
| **B**       | כולל ביטויים כמו "כרטיס עובד", "סה״כ שעות", "תשלום" | דוחות עובדים אישיים     |
| **Unknown** | לא נמצאו מאפיינים ברורים                            | דוחות שלא ניתנים לסיווג |


📂 מבנה הפרויקט
taskToSendInPython/
│
├── data/                   ← קבצי PDF לבדיקה
├── src/
│   ├── extract.py          ← קובץ ראשי: חילוץ וזיהוי
│   ├── mutate.py           ← תיקונים לוגיים (וריאציה)
│   └── generate_pdf.py     ← יצירת PDF חדש
├── venv/                   ← סביבה וירטואלית (לא חובה להעלות ל־Git)
└── README.md               ← קובץ תיעוד זה

🔍 הסבר על הקבצים
📘 extract.py — קובץ ראשי

*בודק אם הקובץ טקסטואלי (pdfplumber) או סרוק (pdf2image + pytesseract)

*מחלץ את הטקסט מהמסמך

*מזהה את סוג הדוח (A/B) לפי מילות מפתח

*שולח את הטקסט המתאים לפונקציית תיקון (normalize_report_a)

*מדפיס נתוני בקרה ומפיק פלט מסכם

✨ פלט לדוגמה
הדף טקסטואלי: False
⚠️ שורה עם כניסה/יציאה לא תקינות תוקנה: יום ראשון | 15:00 08:00 ...
⚠️ ערך 100% עודכן ל-9: יום רביעי | 08:00 15:00 ...
✅ נוצר קובץ PDF חדש

🛠️ mutate.py — תיקונים לוגיים (וריאציות)

מטרתו ליצור גרסה “הגיונית” של הדוח המקורי:

אם שעת היציאה ≤ שעת הכניסה → מתקן ומחליף ביניהן

מזהה עמודת “סה״כ” ולאחריה את עמודת “100%”

אם הערך ב־100% גדול מ־9 שעות → משנה ל־9.00

מדפיס אזהרות על שורות שתוקנו

🧠 פונקציה עיקרית:

def normalize_report_a(text: str) -> str:


מחזירה טקסט מתוקן, מוכן ליצירת דוח חדש.

🖨️ generate_pdf.py — הפקת PDF חדש

יוצר קובץ PDF חדש עם:

עמוד 1 — הטקסט המקורי

עמוד 2 — הטקסט לאחר תיקון

משתמש בספריית reportlab לעיצוב ברור וקריא.

חותך שורות ארוכות, יוצר עמודים חדשים אוטומטית.

📄 פלט לדוגמה:

output/updated_report.pdf

✨ דוגמת פלט JSON
{
  "file": "a_r_9.pdf",
  "is_textual": false,
  "report_type": "A",
  "preview": "נ.ע. הנשר כח אדם בע\"מ...",
  "normalized": {
    "report_type": "A",
    "rows": [...]
  }
}


🧩 פקודות Git בסיסיות

להעלאה ראשונה ל־GitHub:

git init
git add .
git commit -m "Initial commit - PDF OCR system"
git branch -M main
git remote add origin https://github.com/USERNAME/pdf-ocr-extractor.git
git push -u origin main

✅ סיכום

✔ חילוץ טקסטים גם מקבצי PDF סרוקים
✔ סיווג אוטומטי של סוגי דוחות
✔ תיקון לוגי של שעות עבודה
✔ הפקת PDF חדש, ברור וקריא
✔ קוד נקי, מודולרי ומוכן להרחבה

👩‍💻 מפתחת

פותח ע"י י. וגשל
פרויקט לעיבוד מסמכים ו־OCR באמצעות Python
כולל ניתוח, תיקון והפקת דוחות אוטומטית.